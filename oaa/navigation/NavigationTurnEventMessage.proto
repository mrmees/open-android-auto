// Android Auto Protocol Buffer Definitions
// https://github.com/mrmees/open-android-auto
// SPDX-License-Identifier: GPL-3.0-or-later

/*
 * NavigationTurnEvent — turn-by-turn navigation detail.
 *
 * APK class: vzm.java (AA v16.1)
 * Channel: Navigation (channel 10)
 * Message ID: 0x8004 (32772) — sent by phone
 * Dispatched by hkx.java line 1033: hzyVar.k(32772, o.q())
 *
 * Contains turn icon, maneuver type, turn side, and distance.
 * Complements NavigationStep (0x8003) with richer turn detail.
 *
 * VERIFIED active via DHU 2.1 + logcat (2026-02-28):
 * Phone-side class: com.google.android.apps.auto.sdk.nav.state.TurnEvent
 * Fires at ~1Hz during active navigation (Google Maps).
 * Phone logs: CSL.AbstractBundleable: Failed to instantiate TurnEvent
 *   BadParcelableException on obfuscated class "lbg" — version mismatch
 *   between DHU's car app library and phone's AA app, not a proto issue.
 */

syntax = "proto3";

import "oaa/navigation/ManeuverTypeEnum.proto";
import "oaa/navigation/TurnSideEnum.proto";

package oaa.proto.messages;

message NavigationTurnEvent {
    optional string road_name = 1;                   // APK: b — descriptor says string (not bytes)
    optional oaa.proto.enums.ManeuverType.Enum maneuver_type = 2;   // APK: c — descriptor says enum (int32 wire)
    optional oaa.proto.enums.TurnSide.Enum turn_direction = 3;      // APK: d (int, default=1) — validated by vyv.h/vee.Q()
    optional bytes turn_icon = 4;                    // APK: e — descriptor says bytes
    optional int32 distance_meters = 5;              // APK: f (int) — distance to turn
    optional int32 distance_unit = 6;                // APK: g (int) — distance display unit
}
