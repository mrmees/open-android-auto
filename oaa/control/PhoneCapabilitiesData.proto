// Android Auto Protocol Buffer Definitions
// https://github.com/mrmees/open-android-auto
// SPDX-License-Identifier: GPL-3.0-or-later

/*
 * Discovered via APK proto decoder (aagr.java, AA v16.1)
 * Sub-message of ServiceDiscoveryRequest field 2.
 * Describes phone capabilities, device info, and connection preferences.
 */

syntax="proto2";

package oaa.proto.data;

message PhoneCapabilities
{
    optional CapabilityFlag feature_flags = 1;
    optional DeviceInfo device_info = 2;
    optional PhoneConnectionConfig connection_config = 3;
    optional CapabilityPair display_capabilities = 4;
    repeated CapabilityEntry capabilities = 5;
    optional string phone_identifier = 7;
}

// APK class: aagh — boolean flag + name
message CapabilityFlag
{
    optional bool enabled = 1;
    optional string name = 2;
}

// APK class: vve — phone device information (9 fields)
message DeviceInfo
{
    optional string manufacturer = 1;
    optional string model = 2;
    optional string android_version = 3;
    optional string build_fingerprint = 4;
    optional string field_5 = 5;
    optional string field_6 = 6;
    optional string field_7 = 7;
    optional string field_8 = 8;
    optional int32 device_type = 9;
}

// WiFi security mode (APK enum: wdr)
// Used for WiFi Direct connection between phone and HU.
enum WifiSecurityMode {
    WIFI_SECURITY_UNKNOWN = 0;
    WIFI_SECURITY_OPEN = 1;
    WIFI_SECURITY_WEP_64 = 2;
    WIFI_SECURITY_WEP_128 = 3;
    WIFI_SECURITY_WPA_PERSONAL = 4;
    WIFI_SECURITY_WPA2_PERSONAL = 8;
    WIFI_SECURITY_WPA_WPA2_PERSONAL = 12;
    WIFI_SECURITY_WPA_ENTERPRISE = 20;
    WIFI_SECURITY_WPA2_ENTERPRISE = 24;
    WIFI_SECURITY_WPA_WPA2_ENTERPRISE = 28;
    WIFI_SECURITY_WPA3_PERSONAL = 32;
    WIFI_SECURITY_WPA2_WPA3_PERSONAL = 40;
}

// WiFi access point type (APK class: wdm, field 5)
// Determines whether the AP is static or dynamically created.
enum WifiAccessPointType {
    WIFI_AP_STATIC = 0;
    WIFI_AP_DYNAMIC = 1;
}

// APK class: wdm — phone connection config (WiFi info, same structure as WifiInfoResponse)
message PhoneConnectionConfig
{
    optional string ssid = 1;
    optional string bssid = 2;
    optional string passphrase = 3;
    optional WifiSecurityMode security_mode = 4;
    optional WifiAccessPointType ap_type = 5;
}

// APK class: aaft — paired ping configurations
message PingConfigPair
{
    optional PingConfigEntry phone_to_hu = 1;
    optional PingConfigEntry hu_to_phone = 2;
}

// Re-use existing PingConfiguration (zyd) structure
message PingConfigEntry
{
    optional uint32 timeout_ms = 1;
    optional uint32 interval_ms = 2;
    optional uint32 high_latency_threshold_ms = 3;
    optional uint32 tracked_ping_count = 4;
}

// APK class: aags — boolean pair
message CapabilityPair
{
    optional bool value_a = 1;
    optional bool value_b = 2;
}

// APK class: aagv — individual capability entry (10 fields)
// Fields 4-7 are oneof (capability_value)
message CapabilityEntry
{
    optional uint32 capability_id = 1;
    optional string capability_name = 2;
    optional CapabilityEnum capability_type = 3;
    oneof capability_value {
        CapabilityValueMsg value_msg_4 = 4;
        CapabilityValueMsg value_msg_5 = 5;
        CapabilityValueMsg value_msg_6 = 6;
        CapabilityValueMsg value_msg_7 = 7;
    }
    optional bool enabled = 8;
    optional string description = 9;
    repeated CapabilityValueMsg sub_entries = 10;
}

// Placeholder for CapabilityEntry oneof values (sub-message type TBD)
message CapabilityValueMsg {}

// Placeholder enum for capability type (field 3 of aagv)
enum CapabilityEnum {
    CAPABILITY_UNKNOWN = 0;
}
