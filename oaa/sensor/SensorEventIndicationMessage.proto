// SPDX-License-Identifier: GPL-3.0-or-later
// Copyright (C) 2024-2026 Open Android Auto contributors
// Based on works by: f1x.studio (aasdk), opencardev (crankshaft), aa-proxy (aa-proxy-rs)
syntax="proto2";

import "oaa/sensor/GPSLocationData.proto";
import "oaa/sensor/CompassData.proto";
import "oaa/sensor/SpeedData.proto";
import "oaa/sensor/RPMData.proto";
import "oaa/sensor/OdometerData.proto";
import "oaa/sensor/FuelLevelData.proto";
import "oaa/sensor/ParkingBrakeData.proto";
import "oaa/sensor/GearData.proto";
import "oaa/common/DiagnosticsData.proto";
import "oaa/sensor/NightModeData.proto";
import "oaa/sensor/EnvironmentData.proto";
import "oaa/sensor/HVACData.proto";
import "oaa/sensor/DrivingStatusData.proto";
import "oaa/sensor/SteeringWheelData.proto";
import "oaa/sensor/PassengerData.proto";
import "oaa/sensor/DoorData.proto";
import "oaa/sensor/LightData.proto";
import "oaa/sensor/TirePressureData.proto";
import "oaa/sensor/AccelData.proto";
import "oaa/sensor/GyroData.proto";

package oaa.proto.messages;

// Field numbers match SensorTypeEnum values (field 1 = LOCATION = 1, etc.).
// DHU 2.1 verification status (2026-02-28):
//   Fields 1,3,6: functionally confirmed (affect phone behavior), silent in logcat
//   Field 9: enum numbering verified via "no listener" log referencing sensor:9
//   Field 10: fully verified — complete processing pipeline traced in logcat
message SensorEventIndication
{
    repeated data.GPSLocation gps_location = 1;     // LOCATION — functionally verified (DHU 2.1)
    repeated data.Compass compass = 2;               // COMPASS
    repeated data.Speed speed = 3;                   // CAR_SPEED — sent OK, silent in logcat (DHU 2.1)
    repeated data.RPM rpm = 4;                       // RPM
    repeated data.Odometer odometer = 5;             // ODOMETER
    repeated data.FuelLevel fuel_level = 6;           // FUEL_LEVEL — sent successfully (DHU 2.1)
    repeated data.ParkingBrake parking_brake = 7;    // PARKING_BRAKE
    repeated data.Gear gear = 8;                     // GEAR — no DHU 2.1 CLI command
    repeated data.Diagnostics diagnostics = 9;       // DIAGNOSTICS — enum verified (sensor:9 log)
    repeated data.NightMode night_mode = 10;         // NIGHT_DATA — VERIFIED full pipeline
    repeated data.Environment enviorment = 11;

    // Fields 12-20: Removed in AA v16.1 APK (wbo.java only has fields 1-11).
    // Kept for backward compatibility — phone silently ignores unknown fields.
    repeated data.HVAC hvac = 12;
    repeated data.DrivingStatus driving_status = 13;
    repeated data.SteeringWheel steering_wheel = 14;
    repeated data.Passenger passenger = 15;
    repeated data.Door door = 16;
    repeated data.Light light = 17;
    repeated data.TirePressure tire_pressure = 18;
    repeated data.Accel accel = 19;
    repeated data.Gyro gyro = 20;

    // Fields 21-26 discovered via APK proto decoder (wbo.java, AA v16.1).
    repeated TollRoad toll_road = 21;              // APK: vxs (3 fields: int32, int32, message)
    repeated RangeRemaining range_remaining = 22;  // APK: wch (1 field: bool)
    repeated FuelTypeInfo fuel_type_info = 23;     // APK: vvg (empty)
    repeated EVBatteryInfo ev_battery_info = 24;   // APK: wcl (empty)
    repeated EVChargeInfo ev_charge_info = 25;     // APK: wbh (1 field: bytes)
    repeated EVChargeStatus ev_charge_status = 26; // APK: wbf (1 field: bytes)
    // Field 27 (extended_sensor_data) NOT in APK v16.1 — removed.
}

// APK class: vxs — toll road sensor data (3 fields)
// Placeholder — sub-message structure TBD from wire captures
message TollRoad {
    optional int32 toll_status = 1;       // int32
    optional int32 toll_type = 2;         // int32
    optional TollRoadInfo info = 3;       // sub-message
}

// Sub-message of TollRoad field 3 — structure TBD
// Placeholder — sub-message structure TBD from wire captures
message TollRoadInfo {
}

// APK class: wch — range remaining sensor data (1 field)
message RangeRemaining {
    optional bool is_available = 1;       // bool
}

// APK class: vvg — fuel type info sensor data (empty)
// Placeholder — sub-message structure TBD from wire captures
message FuelTypeInfo {
}

// APK class: wcl — EV battery info sensor data (empty)
// Placeholder — sub-message structure TBD from wire captures
message EVBatteryInfo {
}

// APK class: wbh — EV charge info sensor data (1 field)
// Placeholder — sub-message structure TBD from wire captures
message EVChargeInfo {
    optional EVChargeInfoData data = 1;   // sub-message (bytes in APK)
}

// Sub-message of EVChargeInfo — structure TBD
// Placeholder — sub-message structure TBD from wire captures
message EVChargeInfoData {
}

// APK class: wbf — EV charge status sensor data (1 field)
// Placeholder — sub-message structure TBD from wire captures
message EVChargeStatus {
    optional EVChargeStatusData data = 1; // sub-message (bytes in APK)
}

// Sub-message of EVChargeStatus — structure TBD
// Placeholder — sub-message structure TBD from wire captures
message EVChargeStatusData {
}
